###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        20/Oct/2015  12:12:00
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  arm
#    Endian       =  little
#    Source file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\component\MTZPacket.c
#    Command line =  
#        "D:\IAR projects\HR1_0100_00_I720_new2\component\MTZPacket.c" -lcN
#        "D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\List\" -o
#        "D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\Obj\" --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --no_clustering
#        --no_scheduling --debug --endian=little --cpu=ARM926EJ-S -e
#        --fpu=VFP9-S --dlib_config "C:\Program Files\IAR Systems\Embedded
#        Workbench 7.40\arm\INC\c\DLib_Config_Normal.h" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\NXP\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\LIB\include\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\inc\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\Igor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\mal\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\component\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\psupervisor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\virtualMenu\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\callbackElement\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\logictimers\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\zonaVRT\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\" --interwork --cpu_mode arm -On
#        --use_c++_inline
#    List file    =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug
#        xRAM\List\MTZPacket.lst
#    Object file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\Obj\MTZPacket.o
#
###############################################################################

D:\IAR projects\HR1_0100_00_I720_new2\component\MTZPacket.c
      1          /*
      2          #include <vcl.h>
      3          #include <strstrea.h>
      4          #include <math.h>
      5          #include <mem.h>
      6          #include <fstream.h>
      7          #include <strstrea.h>
      8          #include <iomanip.h>
      9          #pragma hdrstop
     10          
     11          #include "vmenuDis.h"
     12          */
     13          
     14          #include <stdio.h>
     15          #include <string.h>
     16          
     17          #include "psuperVisor\supermanager.h"
     18          
     19          #include "bazisdef.h"
     20          #include "virtualMenu\textstreamdef.h"
     21          #include "component\componentdef.h"
     22          #include "virtualMenu\systemmenudef.h"
     23          #include "virtualMenu\ustmanagerdef.h"
     24          #include "psuperVisor\psvisor_helpdef.h"
     25          
     26          #include "virtualMenu\textstreamfnc.h"
     27          #include "virtualMenu\systemmenufnc.h"
     28          
     29          #include "virtualMenu\viewMenuList.h"
     30          #include "virtualMenu\viewmenusub.h"
     31          #include "psuperVisor\psupervisor.h"
     32          
     33          //код компонентов
     34          #define KOD_COMPONENT  MTZ_COMP1
     35          //к-во ступеней
     36          #define CNT_STUPEN_MTZ  5
     37          
     38          //массив клонов - конфигурация
     39          extern COMPONENT_OBJ  cnfCOMPONENT[];
     40          extern COMPONENT_OBJ rpzcomponent_obj;//обект компонента для репозитария
     41          extern LineMenuItem sub_menu_cnf[];
     42          extern char deleteComp[];
     43          
     44          extern char MTZ1_TITLE[];
     45          extern char MTZ2_TITLE[];
     46          extern char MTZ3_TITLE[];
     47          extern char MTZ4_TITLE[];
     48          extern char MTZ5_TITLE[];
     49          
     50          StreamControl controlStruct_MTZ;//управл структура
     51          
     52          void MakePacketMTZ();
     53          char copyMTZ1ToRepozitar(char packet);
     54          char copyMTZ2ToRepozitar(char packet);
     55          
     56          char  *nameStupenMTZ[CNT_STUPEN_MTZ] = {MTZ1_TITLE,
     57                                                  MTZ2_TITLE,
     58                                                  MTZ3_TITLE,
     59                                                  MTZ4_TITLE,
     60                                                  MTZ5_TITLE
     61                                                 };//указатели на имена ступеней
     62          
     63          //меню MTZ
     64          LineMenuItem sub_menu_MTZ[CNT_STUPEN_MTZ+4] =
     65          {
     66            { "МТЗ", NULL},//title
     67            { &controlStruct_MTZ, sub_menu_cnf},//control_item, parent
     68            { deleteComp, (void *)&DeleteComponent1, typeMenuProg},
     69            { NULL, NULL}
     70          };
     71          
     72          char copyMTZpacketToRepozitar(char packet)
     73          {
     74            rpzcomponent_obj.kodC    = KOD_COMPONENT; //код компонента
     75            rpzcomponent_obj.cntClon = CNT_STUPEN_MTZ;//к-во клонов
     76          
     77            if(packet)  return 1;//пакетная регистрация
     78          //найти в конфиг такой же пакет
     79            short dx=0;
     80            while(cnfCOMPONENT[dx].componentEnable)
     81            {
     82              //номер пакетного компонента
     83              if(cnfCOMPONENT[dx].packet==MTZ_PACKET) return 1;//пакетная регистрация
     84              dx++;
     85            }//while
     86          
     87            MakeEmptyTopSub_menu(&(sub_menu_cnf[0]),
     88                                 MAX_CNFCOMPONENT*sizeof(LineMenuItem));//добавить пустую запись в top sub_menu
     89          //новый клон в список
     90            sub_menu_cnf[1+SUBDATA].Line2 = sub_menu_MTZ; //меню компонента
     91            sub_menu_cnf[1+SUBDATA].TypesWin = typeMenuSub;
     92          
     93            TxtStreamInit(&CONTROL_CNF,   &KadrMenuFormat_sub, sub_menu_cnf);//инит control и формир кадра
     94          
     95          //---------MTZ5------------------------------
     96            copyMTZ2ToRepozitar(0);//зарегистрировать в репозитарии
     97            rpzcomponent_obj.twinControl[2].twin_different();//diff to MTZ5
     98            rpzcomponent_obj.packet = MTZ_PACKET;    //номер пакетного компонента
     99          
    100            MakePacketMTZ();//создать пакет MTZ
    101          //---------------------------------------------
    102          
    103          //---------MTZ4------------------------------
    104            copyMTZ2ToRepozitar(0);//зарегистрировать в репозитарии
    105            rpzcomponent_obj.twinControl[1].twin_different();//diff to MTZ4
    106            rpzcomponent_obj.packet = MTZ_PACKET;    //номер пакетного компонента
    107          
    108            MakePacketMTZ();//создать пакет MTZ
    109          //---------------------------------------------
    110          
    111          //---------MTZ3------------------------------
    112            copyMTZ2ToRepozitar(0);//зарегистрировать в репозитарии
    113            rpzcomponent_obj.twinControl[0].twin_different();//diff to MTZ3
    114            rpzcomponent_obj.packet = MTZ_PACKET;    //номер пакетного компонента
    115          
    116            MakePacketMTZ();//создать пакет MTZ
    117          //---------------------------------------------
    118          
    119          //---------MTZ2------------------------------
    120            copyMTZ2ToRepozitar(0);//зарегистрировать в репозитарии MTZ2
    121            rpzcomponent_obj.packet = MTZ_PACKET;    //номер пакетного компонента
    122            MakePacketMTZ();//создать пакет MTZ
    123          //---------------------------------------------
    124          
    125          
    126          //---------MTZ1------------------------------
    127            copyMTZ1ToRepozitar(0);//зарегистрировать в репозитарии MTZ1
    128          
    129            rpzcomponent_obj.packet = -CNT_STUPEN_MTZ;    //к-во клонов в пакете
    130            //добавить имя пакета
    131            strcat(rpzcomponent_obj.nameComponent, " МТЗ");
    132            short ii=0;
    133            while(rpzcomponent_obj.nameComponent[ii]!=' ')
    134            {
    135              ii++;
    136            }
    137            rpzcomponent_obj.nameComponent[ii] = 0;
    138          
    139            MakePacketMTZ();//создать пакет MTZ
    140          
    141            //имена ступеней МТЗ
    142            sub_menu_MTZ[1+SUBDATA].Line1         = nameStupenMTZ[0];
    143            sub_menu_MTZ[1+1+SUBDATA].Line1       = nameStupenMTZ[1];
    144            sub_menu_MTZ[1+1+1+SUBDATA].Line1     = nameStupenMTZ[2];
    145            sub_menu_MTZ[1+1+1+1+SUBDATA].Line1   = nameStupenMTZ[3];
    146            sub_menu_MTZ[1+1+1+1+1+SUBDATA].Line1 = nameStupenMTZ[4];
    147          
    148          //---------------------------------------------
    149            return 1;//пакетная регистрация
    150          }//copyMTZpacketToRepozitar()
    151          
    152          void MakePacketMTZ()
    153          {
    154          //создать пакет
    155          //копировать в тень
    156            memcpy((void*)getShadowBuf(), cnfCOMPONENT, sizeof(COMPONENT_OBJ)*MAX_CNFCOMPONENT);
    157          
    158            memcpy(&(cnfCOMPONENT[0]), &rpzcomponent_obj, sizeof(COMPONENT_OBJ));
    159          
    160          //копировать из тени
    161            memcpy(&(cnfCOMPONENT[1]), (void*)getShadowBuf(), sizeof(COMPONENT_OBJ)*(MAX_CNFCOMPONENT-1));
    162          
    163          
    164            MakeEmptyTopSub_menu(&(sub_menu_MTZ[0]), sizeof(sub_menu_MTZ));//добавить пустую запись в top sub_menu
    165          //новый клон в список
    166            sub_menu_MTZ[1+SUBDATA].Line2 = (void *)&OpenMenuComponent; //меню компонента
    167            sub_menu_MTZ[1+SUBDATA].TypesWin = typeMenuProg;
    168          
    169            TxtStreamInit(&controlStruct_MTZ, &KadrMenuFormat_sub, sub_menu_MTZ);//инит control и формир кадра
    170          //инициализировать обекты в конфигурации
    171            initCOMPONENT(INITUST_TOPCOMP);
    172          
    173          }//MakePacket()
    174          
    175          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      32   MakePacketMTZ
        32   -> MakeEmptyTopSub_menu
        32   -> TxtStreamInit
        32   -> __aeabi_memcpy
        32   -> getShadowBuf
        32   -> initCOMPONENT
      16   copyMTZpacketToRepozitar
        16   -- Indirect call
        16   -> MakeEmptyTopSub_menu
        16   -> MakePacketMTZ
        16   -> TxtStreamInit
        16   -> copyMTZ1ToRepozitar
        16   -> copyMTZ2ToRepozitar
        16   -> strcat


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       4  ??DataTable1_10
       4  ??DataTable1_11
       4  ??DataTable1_2
       4  ??DataTable1_3
       4  ??DataTable1_4
       4  ??DataTable1_5
       4  ??DataTable1_6
       4  ??DataTable1_7
       4  ??DataTable1_8
       4  ??DataTable1_9
       4  ?_0
       8  ?_1
     168  MakePacketMTZ
      40  controlStruct_MTZ
     536  copyMTZpacketToRepozitar
      20  nameStupenMTZ
     108  sub_menu_MTZ

 
  40 bytes in section .bss
 128 bytes in section .data
  12 bytes in section .rodata
 752 bytes in section .text
 
 752 bytes of CODE  memory
  12 bytes of CONST memory
 168 bytes of DATA  memory

Errors: none
Warnings: none
