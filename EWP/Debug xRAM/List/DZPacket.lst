###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        20/Oct/2015  12:11:56
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  arm
#    Endian       =  little
#    Source file  =  D:\IAR projects\HR1_0100_00_I720_new2\component\DZPacket.c
#    Command line =  
#        "D:\IAR projects\HR1_0100_00_I720_new2\component\DZPacket.c" -lcN
#        "D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\List\" -o
#        "D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\Obj\" --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --no_clustering
#        --no_scheduling --debug --endian=little --cpu=ARM926EJ-S -e
#        --fpu=VFP9-S --dlib_config "C:\Program Files\IAR Systems\Embedded
#        Workbench 7.40\arm\INC\c\DLib_Config_Normal.h" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\NXP\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\LIB\include\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\inc\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\Igor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\mal\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\component\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\psupervisor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\virtualMenu\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\callbackElement\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\logictimers\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\zonaVRT\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\" --interwork --cpu_mode arm -On
#        --use_c++_inline
#    List file    =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\List\DZPacket.lst
#    Object file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug xRAM\Obj\DZPacket.o
#
###############################################################################

D:\IAR projects\HR1_0100_00_I720_new2\component\DZPacket.c
      1          /*
      2          #include <vcl.h>
      3          #include <strstrea.h>
      4          #include <math.h>
      5          #include <mem.h>
      6          #include <fstream.h>
      7          #include <strstrea.h>
      8          #include <iomanip.h>
      9          #pragma hdrstop
     10          
     11          #include "vmenuDis.h"
     12          */
     13          
     14          #include <stdio.h>
     15          #include <string.h>
     16          
     17          #include "psuperVisor\supermanager.h"
     18          
     19          #include "bazisdef.h"
     20          #include "virtualMenu\textstreamdef.h"
     21          #include "component\componentdef.h"
     22          #include "virtualMenu\systemmenudef.h"
     23          #include "virtualMenu\ustmanagerdef.h"
     24          #include "psuperVisor\psvisor_helpdef.h"
     25          
     26          #include "virtualMenu\textstreamfnc.h"
     27          #include "virtualMenu\systemmenufnc.h"
     28          
     29          #include "virtualMenu\viewMenuList.h"
     30          #include "virtualMenu\viewmenusub.h"
     31          #include "psuperVisor\psupervisor.h"
     32          
     33          
     34          //код компонентов
     35          #define KOD_COMPONENT  DZ_COMP1
     36          //к-во ступеней
     37          #define CNT_STUPEN_DZ  5
     38          
     39          //массив клонов - конфигурация
     40          extern COMPONENT_OBJ  cnfCOMPONENT[];
     41          extern COMPONENT_OBJ rpzcomponent_obj;//обект компонента для репозитария
     42          extern LineMenuItem sub_menu_cnf[];
     43          extern char deleteComp[];
     44          
     45          extern char DZ1_TITLE[];
     46          extern char DZ2_TITLE[];
     47          extern char DZ3_TITLE[];
     48          extern char DZ4_TITLE[];
     49          extern char DZ5_TITLE[];
     50          
     51          StreamControl controlStruct_DZ;//управл структура
     52          
     53          void MakePacketDZ();
     54          char copyDZ1ToRepozitar(char packet);
     55          char copyDZ2ToRepozitar(char packet);
     56          
     57          char  *nameStupenDZ[CNT_STUPEN_DZ] = {DZ1_TITLE,
     58                                                DZ2_TITLE,
     59                                                DZ3_TITLE,
     60                                                DZ4_TITLE,
     61                                                DZ5_TITLE
     62                                               };//указатели на имена ступеней
     63          //меню DZ
     64          LineMenuItem sub_menu_DZ[CNT_STUPEN_DZ+4] =
     65          {
     66            { "ДЗ", NULL},//title
     67            { &controlStruct_DZ, sub_menu_cnf},//control_item, parent
     68            { deleteComp, (void *)&DeleteComponent1, typeMenuProg},
     69            { NULL, NULL}
     70          };
     71          
     72          char copyDZpacketToRepozitar(char packet)
     73          {
     74            rpzcomponent_obj.kodC    = KOD_COMPONENT; //код компонента
     75            rpzcomponent_obj.cntClon = CNT_STUPEN_DZ;//к-во клонов
     76          
     77            if(packet)  return 1;//пакетная регистрация
     78          //найти в конфиг такой же пакет
     79            short dx=0;
     80            while(cnfCOMPONENT[dx].componentEnable)
     81            {
     82              //номер пакетного компонента
     83              if(cnfCOMPONENT[dx].packet==DZ_PACKET) return 1;//пакетная регистрация
     84              dx++;
     85            }//while
     86          
     87            MakeEmptyTopSub_menu(&(sub_menu_cnf[0]),
     88                                 MAX_CNFCOMPONENT*sizeof(LineMenuItem));//добавить пустую запись в top sub_menu
     89          //новый клон в список
     90            sub_menu_cnf[1+SUBDATA].Line2 = sub_menu_DZ; //меню компонента
     91            sub_menu_cnf[1+SUBDATA].TypesWin = typeMenuSub;
     92          
     93            TxtStreamInit(&CONTROL_CNF, &KadrMenuFormat_sub, sub_menu_cnf);//инит control и формир кадра
     94          
     95          //---------DZ5------------------------------
     96            copyDZ2ToRepozitar(0);//зарегистрировать в репозитарии
     97            rpzcomponent_obj.twinControl[2].twin_different();//diff to DZ4
     98            rpzcomponent_obj.packet = DZ_PACKET;    //номер пакетного компонента
     99          
    100            MakePacketDZ();//создать DZ5
    101          //---------------------------------------------
    102          
    103          //---------DZ4------------------------------
    104            copyDZ2ToRepozitar(0);//зарегистрировать в репозитарии
    105            rpzcomponent_obj.twinControl[1].twin_different();//diff to DZ4
    106            rpzcomponent_obj.packet = DZ_PACKET;    //номер пакетного компонента
    107          
    108            MakePacketDZ();//создать DZ4
    109          //---------------------------------------------
    110          
    111          //---------DZ3------------------------------
    112            copyDZ2ToRepozitar(0);//зарегистрировать в репозитарии
    113            rpzcomponent_obj.twinControl[0].twin_different();//diff to DZ3
    114            rpzcomponent_obj.packet = DZ_PACKET;    //номер пакетного компонента
    115          
    116            MakePacketDZ();//создать DZ3
    117          //---------------------------------------------
    118          
    119          //---------DZ2------------------------------
    120            copyDZ2ToRepozitar(0);//зарегистрировать в репозитарии DZ2
    121            rpzcomponent_obj.packet = DZ_PACKET;    //номер пакетного компонента
    122            MakePacketDZ();//создать DZ2
    123          //---------------------------------------------
    124          
    125          
    126          //---------DZ1------------------------------
    127            copyDZ1ToRepozitar(0);//зарегистрировать в репозитарии DZ1
    128          
    129            rpzcomponent_obj.packet = -CNT_STUPEN_DZ;    //к-во клонов в пакете
    130            //добавить имя пакета
    131            strcat(rpzcomponent_obj.nameComponent, " ДЗ");
    132            short ii=0;
    133            while(rpzcomponent_obj.nameComponent[ii]!=' ')
    134            {
    135              ii++;
    136            }
    137            rpzcomponent_obj.nameComponent[ii] = 0;
    138          
    139            MakePacketDZ();//создать DZ1
    140          
    141          
    142            //имена ступеней DZ
    143            sub_menu_DZ[1+SUBDATA].Line1         = nameStupenDZ[0];
    144            sub_menu_DZ[1+1+SUBDATA].Line1       = nameStupenDZ[1];
    145            sub_menu_DZ[1+1+1+SUBDATA].Line1     = nameStupenDZ[2];
    146            sub_menu_DZ[1+1+1+1+SUBDATA].Line1   = nameStupenDZ[3];
    147            sub_menu_DZ[1+1+1+1+1+SUBDATA].Line1 = nameStupenDZ[4];
    148          
    149          //---------------------------------------------
    150            return 1;//пакетная регистрация
    151          }//copyDZpacketToRepozitar()
    152          
    153          void MakePacketDZ()
    154          {
    155          //создать пакет
    156          //копировать в тень
    157            memcpy((void*)getShadowBuf(), cnfCOMPONENT, sizeof(COMPONENT_OBJ)*MAX_CNFCOMPONENT);
    158          
    159            memcpy(&(cnfCOMPONENT[0]), &rpzcomponent_obj, sizeof(COMPONENT_OBJ));
    160          
    161          //копировать из тени
    162            memcpy(&(cnfCOMPONENT[1]), (void*)getShadowBuf(), sizeof(COMPONENT_OBJ)*(MAX_CNFCOMPONENT-1));
    163          
    164            MakeEmptyTopSub_menu(&(sub_menu_DZ[0]), sizeof(sub_menu_DZ));//добавить пустую запись в top sub_menu
    165          //новый клон в список
    166            sub_menu_DZ[1+SUBDATA].Line2 = (void *)&OpenMenuComponent; //меню компонента
    167            sub_menu_DZ[1+SUBDATA].TypesWin = typeMenuProg;
    168          
    169            TxtStreamInit(&controlStruct_DZ, &KadrMenuFormat_sub, sub_menu_DZ);//инит control и формир кадра
    170          //инициализировать обекты в конфигурации
    171            initCOMPONENT(INITUST_TOPCOMP);
    172          }//MakePacket()
    173          
    174          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      32   MakePacketDZ
        32   -> MakeEmptyTopSub_menu
        32   -> TxtStreamInit
        32   -> __aeabi_memcpy
        32   -> getShadowBuf
        32   -> initCOMPONENT
      16   copyDZpacketToRepozitar
        16   -- Indirect call
        16   -> MakeEmptyTopSub_menu
        16   -> MakePacketDZ
        16   -> TxtStreamInit
        16   -> copyDZ1ToRepozitar
        16   -> copyDZ2ToRepozitar
        16   -> strcat


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       4  ??DataTable1_10
       4  ??DataTable1_11
       4  ??DataTable1_2
       4  ??DataTable1_3
       4  ??DataTable1_4
       4  ??DataTable1_5
       4  ??DataTable1_6
       4  ??DataTable1_7
       4  ??DataTable1_8
       4  ??DataTable1_9
       4  ?_0
       4  ?_1
     168  MakePacketDZ
      40  controlStruct_DZ
     536  copyDZpacketToRepozitar
      20  nameStupenDZ
     108  sub_menu_DZ

 
  40 bytes in section .bss
 128 bytes in section .data
   8 bytes in section .rodata
 752 bytes in section .text
 
 752 bytes of CODE  memory
   8 bytes of CONST memory
 168 bytes of DATA  memory

Errors: none
Warnings: none
