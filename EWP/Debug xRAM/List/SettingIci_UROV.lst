###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.3.8902/W32 for ARM        15/Oct/2015  17:17:47
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  arm
#    Endian       =  little
#    Source file  =  
#        D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\SettingIci\SettingIci_UROV.c
#    Command line =  
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\SettingIci\SettingIci_UROV.c"
#        -lcN "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\Debug xRAM\List\" -o
#        "D:\Program Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\Debug
#        xRAM\Obj\" --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=ARM926EJ-S -e --fpu=VFP9-S --dlib_config "D:\Program Files\IAR
#        Systems\Embedded Workbench 7.2\arm\INC\c\DLib_Config_Normal.h" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\NXP\" -I "D:\Program
#        Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\LIB\include\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\inc\" -I "D:\Program
#        Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\Igor\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\mal\" -I "D:\Program
#        Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\component\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\psupervisor\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\virtualMenu\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\callbackElement\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\logictimers\" -I
#        "D:\Program Files\IAR
#        Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\zonaVRT\" -I "D:\Program
#        Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\..\" --interwork
#        --cpu_mode arm -On --use_c++_inline
#    List file    =  
#        D:\Program Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\Debug
#        xRAM\List\SettingIci_UROV.lst
#    Object file  =  
#        D:\Program Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\EWP\Debug
#        xRAM\Obj\SettingIci_UROV.o
#
###############################################################################

D:\Program Files\IAR Systems\MYWORK\HR1_0100_00_I720_new2\SettingIci\SettingIci_UROV.c
      1          #include "lpc_types.h"
      2          #include "lpc_irq_fiq.h"
      3          #include "lpc_arm922t_cp15_driver.h"
      4          
      5          #include "lpc32xx_hstimer.h"
      6          #include "lpc32xx_ssp.h"
      7          #include "lpc32xx_gpio.h"
      8          
      9          #include "lpc32xx_intc_driver.h"
     10          #include "lpc32xx_clkpwr_driver.h"
     11          
     12          #include "arm926ej_cp15_drv.h"
     13          #include "ttbl.h"
     14          
     15          #include <stdio.h>
     16          #include <string.h>
     17          
     18          #include "psuperVisor\supermanager.h"
     19          
     20          #include "component\componentdef.h"
     21          #include "psuperVisor\psvisor_helpdef.h"
     22          
     23          #include "psuperVisor\psvisor_helpfnc.h"
     24          #include "SettingIci\SettingIci.h"
     25          #include "virtualmenu\systemmenufnc.h"
     26          #include "virtualMenu\rangmanagerfnc.h"
     27          //Iclude "SettingIci\SettingIci.h"
     28          
     29          #include "toSpeedOptim.h"
     30          #include "toSpeedDIS.h"
     31          
     32          #include "header.h"
     33          #include "ici_r_ef.h"
     34          
     35          #define _HIDE_COMPONENT
     36          #include "UROVComponent.c"
     37          #include "MTZ1Component.c"
     38          #include "MTZ2Component.c"
     39          #include "TZNP1Component.c"
     40          #include "DZ1Component.c"
     41          #include "DZ2Component.c"
     42          #include "UMMcomponent.c"
     43          #include "NZOP1component.c"
     44          
     45          extern  long lMtz1,lMtz1Tmr,lSt1,lSt2, lst3, lst4;
     46          
     47          void  SettingIci_UROV()
     48          {
     49          //уставки UROV
     50               lMtz1 = brCfgTbl.arPckpStpmStngStore[0].ownrBrfPickup.ov_range_Urov;
     51               SetUstToClon(UROV_COMP1,  1, MNGUST_UROV, lMtz1);//уставка по току
     52          
     53          //выдержки UROV
     54               lMtz1Tmr = brCfgTbl.arPckpStpmStngStore[0].ownrBrfStageParam.time_stage_Urov1;//Выдержка 1 Ступени УРОВ
     55            SetUstToClon(UROV_COMP1,  1, MNGVID_UROV1, lMtz1Tmr*10);//выдержкa UROV1
     56               lMtz1Tmr = brCfgTbl.arPckpStpmStngStore[0].ownrBrfStageParam.time_stage_Urov2;//Выдержка 2 Ступени УРОВ
     57            SetUstToClon(UROV_COMP1,  1, MNGVID_UROV2, lMtz1Tmr*10);//выдержкa UROV2
     58          
     59          //управление УРОВ
     60            int uprUROV = 0;
     61               lSt1 = brCfgTbl.ownrBrfMng.state_Urov;//Состояние УРОВ
     62            if(lSt1>0) uprUROV |= 1; // WKL
     63            else  uprUROV &= ~1; // OTKL 
     64            SetUstToClon(UROV_COMP1,  1, MNGUPR_UROV, uprUROV);//управление UROV
     65          
     66           extern UNS_32 pUROVcmdMaska[];//определение Запуск UROV
     67          
     68          //Пуск UROV от Защит
     69            for(int i=0; i<DQUADRO; i++) pUROVcmdMaska[i]=0;//Очистить
     70          //----------------------------UMM------------------------------
     71          /*
     72          UMAX1_STP_BRF_ONB                    ,//Сраб UMAX1
     73          UMAX2_STP_BRF_ONB                    ,//Сраб UMAX2
     74          UMIN1_STP_BRF_ONB                    ,//Сраб Umin1
     75          UMIN2_STP_BRF_ONB                    ,//Сраб Umin2 
     76          */
     77              lSt1 = puskUROVotZ(UMAX1_STP_BRF_ONB);//Сраб UMAX1
     78            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD6_UMM, PUSKUROV_SM);//отранж UMAX1 на UROV
     79              lSt1 = puskUROVotZ(UMAX2_STP_BRF_ONB);//Сраб UMAX2
     80            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD8_UMM, PUSKUROV_SM);//отранж UMAX2 на UROV
     81              lSt1 = puskUROVotZ(UMIN1_STP_BRF_ONB);//Сраб UMIN1
     82            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD10_UMM, PUSKUROV_SM);//отранж UMIN1 на UROV
     83              lSt1 = puskUROVotZ(UMIN2_STP_BRF_ONB);//Сраб UMIN2
     84            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD12_UMM, PUSKUROV_SM);//отранж UMIN2 на UROV
     85          
     86          //----------------------------NZOP------------------------------
     87              lSt1 = puskUROVotZ(ZOP1_STP_BRF_ONB);//Пуск от NZOP1
     88            if(lSt1) SetCmdToUVV(NZOP_COMP1,  1, IOCMD5_NZOP1to2, PUSKUROV_SM);//отранж ZOP1 на UROV
     89              lSt1 = puskUROVotZ(ZOP2_STP_BRF_ONB);//Пуск от NZOP2
     90            if(lSt1) SetCmdToUVV(NZOP_COMP1,  2, IOCMD5_NZOP1to2, PUSKUROV_SM);//отранж ZOP2 на UROV
     91          
     92          //----------------------------MTZ------------------------------
     93              lSt1 = puskUROVotZ(MCP1_STP_BRF_ONB);//Пуск от МТЗ1
     94            if(lSt1) SetCmdToUVV(MTZ_COMP1,  1, IOCMD6_MTZ1, PUSKUROV_SM);//отранж MTZ1 на UROV
     95              lSt1 = puskUROVotZ(MCP2_STP_BRF_ONB);//Пуск от МТЗ2
     96            if(lSt1) SetCmdToUVV(MTZ_COMP1,  2, IOCMD8_MTZ2to5, PUSKUROV_SM);//отранж MTZ2 на UROV
     97              lSt1 = puskUROVotZ(MCP3_STP_BRF_ONB);//Пуск от МТЗ3
     98            if(lSt1) SetCmdToUVV(MTZ_COMP1,  3, IOCMD8_MTZ2to5, PUSKUROV_SM);//отранж MTZ3 на UROV
     99              lSt1 = puskUROVotZ(MCP4_STP_BRF_ONB);//Пуск от МТЗ4
    100            if(lSt1) SetCmdToUVV(MTZ_COMP1,  4, IOCMD8_MTZ2to5, PUSKUROV_SM);//отранж MTZ4 на UROV
    101              lSt1 = puskUROVotZ(MCP5_STP_BRF_ONB);//Пуск от МТЗ5
    102            if(lSt1) SetCmdToUVV(MTZ_COMP1,  5, IOCMD8_MTZ2to5, PUSKUROV_SM);//отранж MTZ5 на UROV
    103          
    104          //----------------------------TZNP------------------------------
    105              lSt1 = puskUROVotZ(TZNP1_STP_BRF_ONB);//Сраб ТЗНП1
    106            if(lSt1) SetCmdToUVV(TZNP_COMP1,  1, IOCMD5_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    107              lSt1 = puskUROVotZ(TZNP1_3U0_STP_BRF_ONB);//Сраб ЗНП1(3U0)
    108            if(lSt1) SetCmdToUVV(TZNP_COMP1,  1, IOCMD9_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    109              lSt1 = puskUROVotZ(TZNP1_3I0_STP_BRF_ONB);//Сраб ЗНП1(3I0)
    110            if(lSt1) SetCmdToUVV(TZNP_COMP1,  1, IOCMD7_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    111              lSt1 = puskUROVotZ(TZNP2_STP_BRF_ONB);//Сраб ТЗНП2
    112            if(lSt1) SetCmdToUVV(TZNP_COMP1,  2, IOCMD5_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    113              lSt1 = puskUROVotZ(TZNP2_3U0_STP_BRF_ONB);//Сраб ЗНП2(3U0)
    114            if(lSt1) SetCmdToUVV(TZNP_COMP1,  2, IOCMD9_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    115              lSt1 = puskUROVotZ(TZNP2_3I0_STP_BRF_ONB);//Сраб ЗНП2(3I0)
    116            if(lSt1) SetCmdToUVV(TZNP_COMP1,  2, IOCMD7_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    117              lSt1 = puskUROVotZ(TZNP3_STP_BRF_ONB);//Сраб ТЗНП3
    118            if(lSt1) SetCmdToUVV(TZNP_COMP1,  3, IOCMD5_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    119              lSt1 = puskUROVotZ(TZNP3_3U0_STP_BRF_ONB);//Сраб ЗНП3(3U0)
    120            if(lSt1) SetCmdToUVV(TZNP_COMP1,  3, IOCMD9_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    121              lSt1 = puskUROVotZ(TZNP3_3I0_STP_BRF_ONB);//Сраб ЗНП3(3I0)
    122            if(lSt1) SetCmdToUVV(TZNP_COMP1,  3, IOCMD7_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    123              lSt1 = puskUROVotZ(TZNP4_STP_BRF_ONB);//Сраб ТЗНП4
    124            if(lSt1) SetCmdToUVV(TZNP_COMP1,  4, IOCMD5_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    125              lSt1 = puskUROVotZ(TZNP4_3U0_STP_BRF_ONB);//Сраб ЗНП4(3U0)
    126            if(lSt1) SetCmdToUVV(TZNP_COMP1,  4, IOCMD9_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    127              lSt1 = puskUROVotZ(TZNP4_3I0_STP_BRF_ONB);//Сраб ЗНП4(3I0)
    128            if(lSt1) SetCmdToUVV(TZNP_COMP1,  4, IOCMD7_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    129              lSt1 = puskUROVotZ(TZNP5_STP_BRF_ONB);//Сраб ТЗНП5
    130            if(lSt1) SetCmdToUVV(TZNP_COMP1,  5, IOCMD5_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    131              lSt1 = puskUROVotZ(TZNP5_3U0_STP_BRF_ONB);//Сраб ЗНП5(3U0)
    132            if(lSt1) SetCmdToUVV(TZNP_COMP1,  5, IOCMD9_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    133              lSt1 = puskUROVotZ(TZNP5_3I0_STP_BRF_ONB);//Сраб ЗНП5(3I0)
    134            if(lSt1) SetCmdToUVV(TZNP_COMP1,  5, IOCMD7_TZNP1to5, PUSKUROV_SM);//отранж на UROV
    135          
    136          //----------------------------UMM------------------------------
    137              lSt1 = puskUROVotZ(UMAX1_STP_BRF_ONB);//Сраб UMAX1
    138            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD6_UMM, PUSKUROV_SM);//отранж на UROV
    139          //UMAX1_STP_BRF_ONB                    ,//Сраб UMAX1
    140              lSt1 = puskUROVotZ(UMAX2_STP_BRF_ONB);//Сраб UMAX2
    141            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD8_UMM, PUSKUROV_SM);//отранж на UROV
    142          //UMAX2_STP_BRF_ONB                    ,//Сраб UMAX2
    143              lSt1 = puskUROVotZ(UMIN1_STP_BRF_ONB);//Сраб UMIN1
    144            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD10_UMM, PUSKUROV_SM);//отранж на UROV
    145          //UMIN1_STP_BRF_ONB                    ,//Сраб Umin1
    146              lSt1 = puskUROVotZ(UMIN2_STP_BRF_ONB);//Сраб UMAX1
    147            if(lSt1) SetCmdToUVV(UMM_COMP1,  1, IOCMD12_UMM, PUSKUROV_SM);//отранж на UROV
    148          //UMIN2_STP_BRF_ONB                    ,//Сраб Umin2 
    149          
    150          //----------------------------DZ------------------------------
    151              lSt1 = puskUROVotZ(DSTP1_STP_BRF_ONB);//Сраб ДТЗ1
    152            if(lSt1) {
    153                       SetCmdToUVV(DZ_COMP1,  1, IOCMD3_DZ1, PUSKUROV_SM);//отранж на UROV
    154                       SetCmdToUVV(DZ_COMP1,  1, IOCMD7_DZ1, PUSKUROV_SM);//отранж на UROV
    155                     }//if  
    156              lSt1 = puskUROVotZ(DSTP2_STP_BRF_ONB);//Сраб ДТЗ2
    157            if(lSt1) {
    158                       SetCmdToUVV(DZ_COMP1,  2, IOCMD5_DZ2to5MF, PUSKUROV_SM);//отранж на UROV
    159                       SetCmdToUVV(DZ_COMP1,  2, IOCMD5_DZ2to5OF, PUSKUROV_SM);//отранж на UROV
    160                     }//if  
    161              lSt1 = puskUROVotZ(DSTP3_STP_BRF_ONB);//Сраб ДТЗ3
    162            if(lSt1) {
    163                       SetCmdToUVV(DZ_COMP1,  3, IOCMD5_DZ2to5MF, PUSKUROV_SM);//отранж на UROV
    164                       SetCmdToUVV(DZ_COMP1,  3, IOCMD5_DZ2to5OF, PUSKUROV_SM);//отранж на UROV
    165                     }//if  
    166              lSt1 = puskUROVotZ(DSTP4_STP_BRF_ONB);//Сраб ДТЗ4
    167            if(lSt1) {
    168                       SetCmdToUVV(DZ_COMP1,  4, IOCMD5_DZ2to5MF, PUSKUROV_SM);//отранж на UROV
    169                       SetCmdToUVV(DZ_COMP1,  4, IOCMD5_DZ2to5OF, PUSKUROV_SM);//отранж на UROV
    170                     }//if  
    171              lSt1 = puskUROVotZ(DSTP5_STP_BRF_ONB);//Сраб ДТЗ5
    172            if(lSt1) {
    173                       SetCmdToUVV(DZ_COMP1,  5, IOCMD5_DZ2to5MF, PUSKUROV_SM);//отранж на UROV
    174                       SetCmdToUVV(DZ_COMP1,  5, IOCMD5_DZ2to5OF, PUSKUROV_SM);//отранж на UROV
    175                     }//if  
    176          
    177              lSt1 = puskUROVotZ(MCP1_DSTP1_STP_BRF_ONB);//Сраб МТЗ1 ДТЗ1
    178            if(lSt1) SetCmdToUVV(DZ_COMP1,  1, IOCMD5_DZ1, PUSKUROV_SM);//отранж на UROV
    179              lSt1 = puskUROVotZ(MCP2_DSTP2_STP_BRF_ONB);//Сраб МТЗ2 ДТЗ2
    180            if(lSt1) SetCmdToUVV(DZ_COMP1,  2, IOCMD5_MDZ2to5MF, PUSKUROV_SM);//отранж на UROV
    181              lSt1 = puskUROVotZ(MCP3_DSTP3_STP_BRF_ONB);//Сраб МТЗ3 ДТЗ3
    182            if(lSt1) SetCmdToUVV(DZ_COMP1,  3, IOCMD5_MDZ2to5MF, PUSKUROV_SM);//отранж на UROV
    183              lSt1 = puskUROVotZ(MCP4_DSTP4_STP_BRF_ONB);//Сраб МТЗ4 ДТЗ4
    184            if(lSt1) SetCmdToUVV(DZ_COMP1,  4, IOCMD5_MDZ2to5MF, PUSKUROV_SM);//отранж на UROV
    185              lSt1 = puskUROVotZ(MCP5_DSTP5_STP_BRF_ONB);//Сраб МТЗ5 ДТЗ5
    186            if(lSt1) SetCmdToUVV(DZ_COMP1,  5, IOCMD5_MDZ2to5MF, PUSKUROV_SM);//отранж на UROV
    187          
    188          }//SettingIci_UROV()
    189          
    190          int puskUROVotZ(int num)
    191          {
    192          //Пуск UROV от Защит
    193            int rez=0;
    194              if(brCfgTbl.ownrBrfMng.ar_Brf_Stp_Cmd_state[num/8]&(1<<(num%8))) rez=1;
    195            return rez;
    196          }//puskUROVotZ(int num)

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   SettingIci_UROV
         8   -> SetCmdToUVV
         8   -> SetUstToClon
         8   -> puskUROVotZ
      20   puskUROVotZ
        20 __aeabi_idiv
        20 __aeabi_idivmod


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       4  ??DataTable1_2
       4  ??DataTable1_3
       4  ??DataTable1_4
       4  ??DataTable1_5
       4  ??DataTable1_6
       4  ??DataTable1_7
       4  ??DataTable1_8
    2428  SettingIci_UROV
      88  puskUROVotZ

 
 2 552 bytes in section .text
 
 2 552 bytes of CODE memory

Errors: none
Warnings: none
