###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        20/Oct/2015  12:49:36
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  arm
#    Endian       =  little
#    Source file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\component\DZ3Component.c
#    Command line =  
#        "D:\IAR projects\HR1_0100_00_I720_new2\component\DZ3Component.c" -D
#        _STATIC_MEMORY_BOOT -lcN "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\Debug xFlash\List\" -o "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\Debug xFlash\Obj\" --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --no_clustering
#        --no_scheduling --debug --endian=little --cpu=ARM926EJ-S -e
#        --fpu=VFP9-S --dlib_config "C:\Program Files\IAR Systems\Embedded
#        Workbench 7.40\arm\INC\c\DLib_Config_Normal.h" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\NXP\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\LIB\include\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\inc\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\Igor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\mal\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\component\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\psupervisor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\virtualMenu\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\callbackElement\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\logictimers\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\zonaVRT\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\" --cpu_mode arm -On
#        --use_c++_inline
#    List file    =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug
#        xFlash\List\DZ3Component.lst
#    Object file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug
#        xFlash\Obj\DZ3Component.o
#
###############################################################################

D:\IAR projects\HR1_0100_00_I720_new2\component\DZ3Component.c
      1          #ifndef _HIDE_COMPONENT
      2          /*
      3          #include <vcl.h>
      4          #include <strstrea.h>
      5          #include <math.h>
      6          #include <mem.h>
      7          #include <fstream.h>
      8          #include <strstrea.h>
      9          #include <iomanip.h>
     10          #pragma hdrstop
     11          
     12          #include "vmenuDis.h"
     13          */
     14          
     15          #include <stdio.h>
     16          #include <string.h>
     17          
     18          #include "bazisdef.h"
     19          #include "component\componentdef.h"
     20          #include "virtualMenu\systemmenudef.h"
     21          #include "virtualMenu\ustmanagerdef.h"
     22          #include "psuperVisor\psvisor_helpdef.h"
     23          
     24          #include "virtualMenu\textstreamfnc.h"
     25          #include "virtualMenu\systemmenufnc.h"
     26          #include "virtualMenu\ustmanagerfnc.h"
     27          #include "psuperVisor\psvisor_helpfnc.h"
     28          #include "virtualMenu\rangmanagerfnc.h"
     29          
     30          #include "virtualMenu\viewMenuList.h"
     31          
     32          #include "..\bazis.h"
     33          
     34          #include "zonaVRT\zonaVRTdef.h"
     35          #include "zonaVRT\zonaVRTfnc.h"
     36          
     37          
     38          //код компонентов
     39          #define KOD_COMPONENT  DZ_COMP1
     40          //к-во ступеней
     41          #define CNT_STUPEN_DZ  5
     42          
     43          #endif // _HIDE_COMPONENT
     44          
     45          #ifndef _HIDE_COMPONENT
     46          
     47          #define _HIDE_COMPONENT
     48          #include "DZ2Component.c"
     49          
     50          extern COMPONENT_OBJ rpzcomponent_obj;//обект компонента для репозитария
     51          extern int  tmpUSTAVKI[];
     52          
     53          extern LineMenuItem sub_menu_cnf[];
     54          extern LineMenuItem sub_menu_DZ[];
     55          extern LineMenuItem sub_menu_tmp[];
     56          extern int  IndexUstSPV;//индекс уставок в супервизоре
     57          
     58          extern COMPONENT_OBJ  cnfCOMPONENT[];
     59          extern int  spvUSTAVKI[];//текущие уставки супервизора
     60          
     61          void PereinitUstListCompDZ3(short flg);
     62          void UstListCompDZ3();
     63          void ustRedactorCompDZ3();
     64          void UstCompDZ3();
     65          
     66          void PereinitVidListCompDZ3(short flg);
     67          void VidListCompDZ3();
     68          void vidRedactorCompDZ3();
     69          void VidCompDZ3();
     70          
     71          void PereinitUprListCompDZ3(short flg);
     72          void UprListCompDZ3();
     73          void uprRedactorCompDZ3();
     74          void UprCompDZ3();
     75          short  KadrMenuFormat_upr_compDZ3(void *workCntr);
     76          int  initUstDZ3(char init);
     77          void  prepareUstDZ2(short idxC);
     78          void  prepareUstDZ3(short idxC);
     79          short  KadrMenuFormat_ustvidDZ(void *workCntr);
     80          char *selectorUprStrDZ2(short iBit, UNS_32 ustUpr);
     81          
     82          //int ViewerEditUstDZ3();
     83          //int ViewerEditVidDZ3();
     84          void EditUprDZ3();
     85          void EditVidDZ3();
     86          void EditUstDZ3();
     87          int codecUstDZ3(char codec, short offset, int ust);
     88          int codecUstDZ2(char codec, short offset, int ust);
     89          int initUstDZ2(char init);
     90          
     91          char DZ3_TITLE[] = "ДЗ3";
     92          
     93          IONAMESTATUS_COMPONENT ionsDZ3[IOCMD_DZ2to5_TOTAL] =
     94          {
     95            {
     96              1,//статус iocmd1
     97              "Стат блок ДЗ3"
     98            },
     99            {
    100              1,//статус iocmd2
    101              "Блок уск ДЗ3"
    102            },
    103            {
    104              1,//статус iocmd3
    105              "Операт уск ДЗ3"
    106            },
    107            {
    108              1,//статус iocmd4
    109              "Сраб ПО ДЗ3МФ"
    110            },
    111            {
    112              1,//статус iocmd5
    113              "Сраб ДЗ3МФ"
    114            },
    115            {
    116              1,//статус iocmd6
    117              "Сраб ПО МТЗ ДЗ3МФ"
    118            },
    119            {
    120              1,//статус iocmd7
    121              "Сраб МТЗ ДЗ3МФ"
    122            },
    123            {
    124              1,//статус iocmd8
    125              "Сраб ПО ДЗ3ОФ"
    126            },
    127            {
    128              1,//статус iocmd9
    129              "Сраб ДЗ3ОФ"
    130            },
    131            {
    132              1,//статус iocmd10
    133              "Теле уск ДЗ3"
    134            }
    135          };
    136          
    137          LineMenuItem sub_menu_comp_DZ3[8] =
    138          {
    139            { DZ3_TITLE, NULL},//title
    140            { &CONTROL1_COMP, &sub_menu_DZ, typeMenuSub},//control_item, parent
    141            { "Уставки ДЗ3",     (void *)&UstListCompDZ3, typeMenuProg},
    142            { "Выдержки ДЗ3",    (void *)&VidListCompDZ3, typeMenuProg},
    143            { "Управление ДЗ3",  (void *)&UprListCompDZ3, typeMenuProg},
    144            { NULL, NULL}
    145          };
    146          
    147          LineMenuItem sub_menu_ust_compDZ3[] =
    148          {
    149            { "Уставки ДЗ3", NULL},//title
    150            { &CONTROL2_COMP, sub_menu_comp_DZ3, typeMenuList},//control_item, parent
    151            { "Уст ДЗ3",        (void *)&UstCompDZ3, typeMenuProg},
    152            { "Уст ДЗ3 вперед", (void *)&UstCompDZ3, typeMenuProg},
    153            { "Уст ДЗ3 назад",  (void *)&UstCompDZ3, typeMenuProg},
    154            { "Уст ДЗ3 ПМ",     (void *)&UstCompDZ3, typeMenuProg},
    155            { NULL, NULL}
    156          
    157          };
    158          
    159          LineMenuItem sub_menu_vid_compDZ3[] =
    160          {
    161            { "Выдержки ДЗ3", NULL},//title
    162            { &CONTROL2_COMP, sub_menu_comp_DZ3, typeMenuList},//control_item, parent
    163          /*
    164            { "Выдержка ДЗ3МФ",       (void*)&VidCompDZ3, typeMenuProg},
    165            { "Выдержка МТЗ ДЗ3МФ",   (void*)&VidCompDZ3, typeMenuProg},
    166            { "Выдержка ДЗ3ОФ",       (void*)&VidCompDZ3, typeMenuProg},
    167            { "Ввод ускор ДЗ3МФ",     (void*)&VidCompDZ3, typeMenuProg},
    168            { "Ввод ускор МТЗ ДЗ3МФ", (void*)&VidCompDZ3, typeMenuProg},
    169          
    170            { "Ускор ДЗ3МФ ВВ",       (void*)&VidCompDZ3, typeMenuProg},
    171            { "Ускор ДЗ3МФ ОУ",       (void*)&VidCompDZ3, typeMenuProg},
    172            { "Ускор ДЗ3МФ ТУ",       (void*)&VidCompDZ3, typeMenuProg},
    173          
    174            { "Ускор МТЗ ДЗ3МФ ВВ",   (void*)&VidCompDZ3, typeMenuProg},
    175            { "Ускор МТЗ ДЗ3МФ ОУ",   (void*)&VidCompDZ3, typeMenuProg},
    176            { "Ускор МТЗ ДЗ3МФ ТУ",   (void*)&VidCompDZ3, typeMenuProg},
    177          
    178            { "Ускор ДЗ3ОФ ВВ",       (void*)&VidCompDZ3, typeMenuProg},
    179            { "Ускор ДЗ3ОФ ОУ",       (void*)&VidCompDZ3, typeMenuProg},
    180            { "Ускор ДЗ3ОФ ТУ",       (void*)&VidCompDZ3, typeMenuProg},
    181          */
    182            { NULL, NULL}
    183          
    184          };
    185          
    186          LineMenuItem sub_menu_upr_compDZ3[] =
    187          {
    188            { "Управл ДЗ3", NULL},//title
    189            { &CONTROL2_COMP, sub_menu_comp_DZ3, typeMenuList},//control_item, parent
    190          /*  
    191            { "Управл ДЗ3",        (void *)&UprCompDZ3, typeMenuProg},
    192            { "Управл МТЗ ДЗ3",    (void *)&UprCompDZ3, typeMenuProg},
    193            { "Ускор ВВ ДЗ3",      (void *)&UprCompDZ3, typeMenuProg},
    194            { "Автомат уск ДЗ3",   (void *)&UprCompDZ3, typeMenuProg},
    195            { "Телеускор ДЗ3",     (void *)&UprCompDZ3, typeMenuProg},
    196          */  
    197            { NULL, NULL}
    198          
    199          };
    200          
    201          void PereinitUstListCompDZ3(short flg)
    202          {
    203          //переиниц
    204            //инит компонентного контроля
    205            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_ustvidDZ, sub_menu_ust_compDZ3);//инит control и формир кадра
    206            if(flg==0)//END
    207            {
    208              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    209            }//if
    210          
    211            ViewDiskrMenuList();//вывести окно отображения
    212            ListPStr();//доступ к уставкам
    213          }//PereinitUstListComp3()
    214          
    215          void UstListCompDZ3()
    216          {
    217            SelectorMNGBAZA(0);//установка базу уставок
    218          
    219            SelectorSUBMENU(sub_menu_ust_compDZ3);//уcтановить текущее субменю
    220          
    221            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    222          
    223            SelectorFHOME(&PereinitUstListCompDZ3);//указатель на ф-цию HOME
    224            InitFHOME(1);//exe ф-цию HOME
    225          
    226            LanderUpDown();//wkl Up Down
    227          }//UstListCompDZ3()
    228          
    229          void UstCompDZ3()
    230          {
    231            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    232            PrepareEditMenu(sub_menu_ust_compDZ3);
    233            PassWord(EditUstDZ3);
    234          }//VidCompDZ3()
    235          
    236          void EditUstDZ3()
    237          {
    238          //редактировать уставку
    239            SystemEditUst(sub_menu_ust_compDZ3);//[LIGHTLINEMENU +1+SUBDATA].Line1, LIGHTLINEMENU);
    240          }//UstCompDZ3()
    241          
    242          //--------------------------------------------------
    243          
    244          void PereinitVidListCompDZ3(short flg)
    245          {
    246          //переиниц
    247            //инит компонентного контроля
    248            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_ustvidDZ, sub_menu_vid_compDZ3);//инит control и формир кадра
    249            if(flg==0)//END
    250            {
    251              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    252            }//if
    253          
    254            ViewDiskrMenuList();//вывести окно отображения
    255            ListPStr();//доступ к уставкам
    256          }//PereinitVidListCompDZ3(short flg)
    257          
    258          void VidListCompDZ3()
    259          {
    260            SelectorMNGBAZA(MNGVID_DZ2to5MF);//установка базы уставок
    261          
    262            SelectorSUBMENU(sub_menu_vid_compDZ3);//утановить текущее субменю
    263          
    264            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    265          
    266            SelectorFHOME(&PereinitVidListCompDZ3);//указатель на ф-цию HOME
    267            InitFHOME(1);//exe ф-цию HOME
    268          
    269            LanderUpDown();//wkl Up Down
    270          }//VidListCompDZ3()
    271          
    272          void VidCompDZ3()
    273          {
    274            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    275            PrepareEditMenu(sub_menu_vid_compDZ3);
    276          //  PassWord(EditVidAPV);
    277            EditVidDZ3();
    278          }//VidCompDZ3()
    279          
    280          void EditVidDZ3()
    281          {
    282          //редактировать уставку
    283            SystemEditUst(sub_menu_vid_compDZ3);//[LIGHTLINEMENU +1+SUBDATA].Line1, LIGHTLINEMENU);
    284          }//
    285          
    286          //--------------------------------------------------
    287          
    288          void PereinitUprListCompDZ3(short flg)
    289          {
    290          //переиниц
    291            //инит компонентного контроля
    292            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_upr_compDZ3, NULL);//инит control и формир кадра
    293            if(flg==0)//END
    294            {
    295              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    296            }//if
    297          
    298            ViewDiskrMenuList();//вывести окно отображения
    299            ListPStr();//доступ к уставкам
    300          }//PereinitUstListComp2()
    301          
    302          void UprListCompDZ3()
    303          {
    304            SelectorMNGBAZA(MNGUPR_DZ2to5);//установка базы уставок
    305          
    306            SelectorSUBMENU(sub_menu_upr_compDZ3);//утановить текущее субменю
    307          
    308            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    309          
    310            SelectorFHOME(&PereinitUprListCompDZ3);//указатель на ф-цию HOME
    311            InitFHOME(1);//exe ф-цию HOME
    312          
    313            LanderUpDown();//wkl Up Down
    314          }//VidListCompDZ3()
    315          
    316          void UprCompDZ3()
    317          {
    318            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    319            PrepareEditMenu(sub_menu_upr_compDZ3);
    320            PassWord(EditUprDZ3);
    321          
    322          }//UprCompMTZ3()
    323          
    324          void EditUprDZ3()
    325          {
    326          //редактировать уставку упр
    327            char *nameUpr = (char *)sub_menu_upr_compDZ3[LIGHTLINEMENU +1+SUBDATA].Line1;
    328            UpravlRedactor(nameUpr, LIGHTLINEMENU, &selectorUprStrDZ2);//редактировать уставку управления
    329          }//EditUprDZ3()
    330          
    331          short  KadrMenuFormat_upr_compDZ3(void *pstr)
    332          {
    333           WorkControl *workCntr = (WorkControl *)pstr;
    334          //формирователь кадра
    335            RESET_COUNTER;//сброс счетчиков
    336            for(int i=0;; i++)
    337            {
    338          //критерий терминатора
    339              char *nameUpr = (char *)sub_menu_upr_compDZ3[i+1+SUBDATA].Line1;
    340              if(nameUpr==NULL) break;
    341          
    342              COMPARE_COUNTER
    343              {
    344                strcpy((char *)workCntr->twoString, nameUpr);
    345          
    346                strcpy((char *)workCntr->twoString + sizeof(WorkVariantChar)/2,
    347                selectorUprStrDZ2(i, getCurrentMngUSTAVKI()));
    348          
    349                return 1;//сравнить счетчики кадров
    350              }
    351            }//for
    352          
    353            return 1;
    354          }//KadrMenuFormat_upr_compDZ3(WorkControl *workCntr)
    355          
    356          int initUstDZ3(char init)
    357          {
    358           return initUstDZ2(init);
    359          }//initUstDZ3(short mngUst, char init)
    360          
    361          void  prepareUstDZ3(short idxC)
    362          {
    363            prepareUstDZ2(idxC);
    364          }//prepareUstDZ3(short idxC)
    365          
    366          int codecUstDZ3(char codec, short offset, int ust)
    367          //codec=0-кодировать
    368          //codec=1-раскодировать
    369          {
    370            //кодировать-раскодировать уставку
    371            return codecUstDZ2(codec, offset, ust);
    372          }//codecUstDZ3(char *buf, short offset, int ust)
    373          
    374          void diffDZ3ToRepozitar()
    375          {
    376          //копировать изменения компонента в репозитарий
    377            rpzcomponent_obj.componentEnable = 1;//разрешение компонента
    378            rpzcomponent_obj.kodC   = KOD_COMPONENT;         //код компонента
    379            rpzcomponent_obj.permanent = 0; //перманентный компонент
    380          
    381            strcpy(rpzcomponent_obj.nameComponent,  DZ3_TITLE);       //имя компонента
    382            rpzcomponent_obj.sub_menu_component =  sub_menu_comp_DZ3;//sub_menu_component;
    383          
    384            rpzcomponent_obj.cntClon     = CNT_STUPEN_DZ;   //к-во клонов
    385            rpzcomponent_obj.numClon     = 3;//номер клона
    386            rpzcomponent_obj.workToSignal = 0; //Работа на сигнал
    387          
    388            rpzcomponent_obj.initUstMng     = initUstDZ3;    //инициал уставок
    389            rpzcomponent_obj.prepareUstSpv  = prepareUstDZ3;//подготовка уставок
    390          
    391            rpzcomponent_obj.nameStatusIO = ionsDZ3;          //имена и статус команд IO
    392          
    393            rpzcomponent_obj.codecUst = codecUstDZ3;   //кодировать-раскодировать уставку
    394          
    395          }//
    396          
    397          #endif // _HIDE_COMPONENT
    398          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   EditUprDZ3
         8   -> UpravlRedactor
       8   EditUstDZ3
         8   -> SystemEditUst
       8   EditVidDZ3
         8   -> SystemEditUst
      24   KadrMenuFormat_upr_compDZ3
        24   -> getCurrentMngUSTAVKI
        24   -> selectorUprStrDZ2
        24   -> strcpy
       8   PereinitUprListCompDZ3
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   PereinitUstListCompDZ3
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   PereinitVidListCompDZ3
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   UprCompDZ3
         8   -> PassWord
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   UprListCompDZ3
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
       8   UstCompDZ3
         8   -> PassWord
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   UstListCompDZ3
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
       8   VidCompDZ3
         8   -> EditVidDZ3
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   VidListCompDZ3
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
      16   codecUstDZ3
        16   -> codecUstDZ2
       8   diffDZ3ToRepozitar
         8   -> strcpy
       8   initUstDZ3
         8   -> initUstDZ2
       8   prepareUstDZ3
         8   -> prepareUstDZ2


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable13
       4  ??DataTable13_1
       4  ??DataTable13_10
       4  ??DataTable13_11
       4  ??DataTable13_2
       4  ??DataTable13_3
       4  ??DataTable13_4
       4  ??DataTable13_5
       4  ??DataTable13_6
       4  ??DataTable13_7
       4  ??DataTable13_8
       4  ??DataTable13_9
      16  ?_0
      16  ?_1
      12  ?_10
      16  ?_11
      16  ?_12
       8  ?_13
      16  ?_14
      16  ?_15
      12  ?_16
      12  ?_17
      16  ?_2
      16  ?_3
      12  ?_4
      20  ?_5
      16  ?_6
      16  ?_7
      12  ?_8
      16  ?_9
       4  DZ3_TITLE
      52  EditUprDZ3
      16  EditUstDZ3
      16  EditVidDZ3
     160  KadrMenuFormat_upr_compDZ3
      68  PereinitUprListCompDZ3
      68  PereinitUstListCompDZ3
      68  PereinitVidListCompDZ3
      28  UprCompDZ3
      52  UprListCompDZ3
      28  UstCompDZ3
      52  UstListCompDZ3
      24  VidCompDZ3
      52  VidListCompDZ3
      48  codecUstDZ3
     152  diffDZ3ToRepozitar
      24  initUstDZ3
      80  ionsDZ3
      28  prepareUstDZ3
      96  sub_menu_comp_DZ3
      36  sub_menu_upr_compDZ3
      84  sub_menu_ust_compDZ3
      36  sub_menu_vid_compDZ3

 
 336 bytes in section .data
 264 bytes in section .rodata
 984 bytes in section .text
 
 984 bytes of CODE  memory
 264 bytes of CONST memory
 336 bytes of DATA  memory

Errors: none
Warnings: none
