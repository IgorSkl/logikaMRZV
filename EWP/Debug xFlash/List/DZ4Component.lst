###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        20/Oct/2015  12:49:36
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  arm
#    Endian       =  little
#    Source file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\component\DZ4Component.c
#    Command line =  
#        "D:\IAR projects\HR1_0100_00_I720_new2\component\DZ4Component.c" -D
#        _STATIC_MEMORY_BOOT -lcN "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\Debug xFlash\List\" -o "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\Debug xFlash\Obj\" --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --no_clustering
#        --no_scheduling --debug --endian=little --cpu=ARM926EJ-S -e
#        --fpu=VFP9-S --dlib_config "C:\Program Files\IAR Systems\Embedded
#        Workbench 7.40\arm\INC\c\DLib_Config_Normal.h" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\NXP\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\LIB\include\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\inc\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\Igor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\mal\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\component\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\psupervisor\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\virtualMenu\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\callbackElement\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\logictimers\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\zonaVRT\" -I "D:\IAR
#        projects\HR1_0100_00_I720_new2\EWP\..\" --cpu_mode arm -On
#        --use_c++_inline
#    List file    =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug
#        xFlash\List\DZ4Component.lst
#    Object file  =  
#        D:\IAR projects\HR1_0100_00_I720_new2\EWP\Debug
#        xFlash\Obj\DZ4Component.o
#
###############################################################################

D:\IAR projects\HR1_0100_00_I720_new2\component\DZ4Component.c
      1          #ifndef _HIDE_COMPONENT
      2          /*
      3          #include <vcl.h>
      4          #include <strstrea.h>
      5          #include <math.h>
      6          #include <mem.h>
      7          #include <fstream.h>
      8          #include <strstrea.h>
      9          #include <iomanip.h>
     10          #pragma hdrstop
     11          
     12          #include "vmenuDis.h"
     13          */
     14          
     15          #include <stdio.h>
     16          #include <string.h>
     17          
     18          #include "bazisdef.h"
     19          #include "component\componentdef.h"
     20          #include "virtualMenu\systemmenudef.h"
     21          #include "virtualMenu\ustmanagerdef.h"
     22          #include "psuperVisor\psvisor_helpdef.h"
     23          
     24          #include "virtualMenu\textstreamfnc.h"
     25          #include "virtualMenu\systemmenufnc.h"
     26          #include "virtualMenu\ustmanagerfnc.h"
     27          #include "psuperVisor\psvisor_helpfnc.h"
     28          #include "virtualMenu\rangmanagerfnc.h"
     29          
     30          #include "virtualMenu\viewMenuList.h"
     31          
     32          #include "..\bazis.h"
     33          
     34          #include "zonaVRT\zonaVRTdef.h"
     35          #include "zonaVRT\zonaVRTfnc.h"
     36          
     37          //код компонентов
     38          #define KOD_COMPONENT  DZ_COMP1
     39          //к-во ступеней
     40          #define CNT_STUPEN_DZ  5
     41          
     42          #endif // _HIDE_COMPONENT
     43          
     44          #ifndef _HIDE_COMPONENT
     45          
     46          #define _HIDE_COMPONENT
     47          #include "DZ2Component.c"
     48          
     49          extern COMPONENT_OBJ rpzcomponent_obj;//обект компонента для репозитария
     50          extern int  tmpUSTAVKI[];
     51          
     52          extern LineMenuItem sub_menu_cnf[];
     53          extern LineMenuItem sub_menu_DZ[];
     54          extern LineMenuItem sub_menu_tmp[];
     55          extern int  IndexUstSPV;//индекс уставок в супервизоре
     56          
     57          extern COMPONENT_OBJ  cnfCOMPONENT[];
     58          extern int  spvUSTAVKI[];//текущие уставки супервизора
     59          
     60          void PereinitUstListCompDZ4(short flg);
     61          void UstListCompDZ4();
     62          void ustRedactorCompDZ4();
     63          void UstCompDZ4();
     64          
     65          void PereinitVidListCompDZ4(short flg);
     66          void VidListCompDZ4();
     67          void vidRedactorCompDZ4();
     68          void VidCompDZ4();
     69          
     70          void PereinitUprListCompDZ4(short flg);
     71          void UprListCompDZ4();
     72          void uprRedactorCompDZ4();
     73          void UprCompDZ4();
     74          short  KadrMenuFormat_upr_compDZ4(void *workCntr);
     75          int   initUstDZ4(char init);
     76          void  prepareUstDZ2(short idxC);
     77          void  prepareUstDZ4(short idxC);
     78          
     79          //int ViewerEditUstDZ4();
     80          //int ViewerEditVidDZ4();
     81          void EditUprDZ4();
     82          void EditVidDZ4();
     83          void EditUstDZ4();
     84          int codecUstDZ4(char codec, short offset, int ust);
     85          int codecUstDZ2(char codec, short offset, int ust);
     86          int initUstDZ2(char init);
     87          
     88          short  KadrMenuFormat_ustvidDZ(void *workCntr);
     89          char *selectorUprStrDZ2(short iBit, UNS_32 ustUpr);
     90          
     91          char DZ4_TITLE[] = "ДЗ4";
     92          
     93          IONAMESTATUS_COMPONENT ionsDZ4[IOCMD_DZ2to5_TOTAL] =
     94          {
     95            {
     96              1,//статус iocmd1
     97              "Стат блок ДЗ4"
     98            },
     99            {
    100              1,//статус iocmd2
    101              "Блок уск ДЗ4"
    102            },
    103            {
    104              1,//статус iocmd3
    105              "Операт уск ДЗ4"
    106            },
    107            {
    108              1,//статус iocmd4
    109              "Сраб ПО ДЗ4МФ"
    110            },
    111            {
    112              1,//статус iocmd5
    113              "Сраб ДЗ4МФ"
    114            },
    115            {
    116              1,//статус iocmd6
    117              "Сраб ПО МТЗ ДЗ4МФ"
    118            },
    119            {
    120              1,//статус iocmd7
    121              "Сраб МТЗ ДЗ4МФ"
    122            },
    123            {
    124              1,//статус iocmd8
    125              "Сраб ПО ДЗ4ОФ"
    126            },
    127            {
    128              1,//статус iocmd9
    129              "Сраб ДЗ4ОФ"
    130            },
    131            {
    132              1,//статус iocmd10
    133              "Теле уск ДЗ4"
    134            }
    135          };
    136          
    137          LineMenuItem sub_menu_comp_DZ4[8] =
    138          {
    139            { DZ4_TITLE, NULL},//title
    140            { &CONTROL1_COMP, &sub_menu_DZ, typeMenuSub},//control_item, parent
    141            { "Уставки ДЗ4",     (void *)&UstListCompDZ4, typeMenuProg},
    142            { "Выдержки ДЗ4",    (void *)&VidListCompDZ4, typeMenuProg},
    143            { "Управление ДЗ4",  (void *)&UprListCompDZ4, typeMenuProg},
    144            { NULL, NULL}
    145          };
    146          
    147          LineMenuItem sub_menu_ust_compDZ4[] =
    148          {
    149            { "Уставки ДЗ4", NULL},//title
    150            { &CONTROL2_COMP, sub_menu_comp_DZ4, typeMenuList},//control_item, parent
    151            { "Уст ДЗ4",        (void *)&UstCompDZ4, typeMenuProg},
    152            { "Уст ДЗ4 вперед", (void *)&UstCompDZ4, typeMenuProg},
    153            { "Уст ДЗ4 назад",  (void *)&UstCompDZ4, typeMenuProg},
    154            { "Уст ДЗ4 ПМ",     (void *)&UstCompDZ4, typeMenuProg},
    155            { NULL, NULL}
    156          
    157          };
    158          
    159          LineMenuItem sub_menu_vid_compDZ4[] =
    160          {
    161            { "Выдержки ДЗ4", NULL},//title
    162            { &CONTROL2_COMP, sub_menu_comp_DZ4, typeMenuList},//control_item, parent
    163          /*
    164            { "Выдержка ДЗ4МФ",       (void*)&VidCompDZ4, typeMenuProg},
    165            { "Выдержка МТЗ ДЗ4МФ",   (void*)&VidCompDZ4, typeMenuProg},
    166            { "Выдержка ДЗ4ОФ",       (void*)&VidCompDZ4, typeMenuProg},
    167            { "Ввод ускор ДЗ4МФ",     (void*)&VidCompDZ4, typeMenuProg},
    168            { "Ввод ускор МТЗ ДЗ4МФ", (void*)&VidCompDZ4, typeMenuProg},
    169          
    170            { "Ускор ДЗ4МФ ВВ",       (void*)&VidCompDZ4, typeMenuProg},
    171            { "Ускор ДЗ4МФ ОУ",       (void*)&VidCompDZ4, typeMenuProg},
    172            { "Ускор ДЗ4МФ ТУ",       (void*)&VidCompDZ4, typeMenuProg},
    173          
    174            { "Ускор МТЗ ДЗ4МФ ВВ",   (void*)&VidCompDZ4, typeMenuProg},
    175            { "Ускор МТЗ ДЗ4МФ ОУ",   (void*)&VidCompDZ4, typeMenuProg},
    176            { "Ускор МТЗ ДЗ4МФ ТУ",   (void*)&VidCompDZ4, typeMenuProg},
    177          
    178            { "Ускор ДЗ4ОФ ВВ",       (void*)&VidCompDZ4, typeMenuProg},
    179            { "Ускор ДЗ4ОФ ОУ",       (void*)&VidCompDZ4, typeMenuProg},
    180            { "Ускор ДЗ4ОФ ТУ",       (void*)&VidCompDZ4, typeMenuProg},
    181          */
    182            { NULL, NULL}
    183          
    184          };
    185          
    186          LineMenuItem sub_menu_upr_compDZ4[] =
    187          {
    188            { "Управл ДЗ4", NULL},//title
    189            { &CONTROL2_COMP, sub_menu_comp_DZ4, typeMenuList},//control_item, parent
    190            { "Управл ДЗ4",        (void *)&UprCompDZ4, typeMenuProg},
    191            { "Управл МТЗ ДЗ4",    (void *)&UprCompDZ4, typeMenuProg},
    192            { "Ускор ВВ ДЗ4",      (void *)&UprCompDZ4, typeMenuProg},
    193            { "Автомат уск ДЗ4",   (void *)&UprCompDZ4, typeMenuProg},
    194            { "Телеускор ДЗ4",     (void *)&UprCompDZ4, typeMenuProg},
    195            { NULL, NULL}
    196          
    197          };
    198          
    199          void PereinitUstListCompDZ4(short flg)
    200          {
    201          //переиниц
    202            //инит компонентного контроля
    203            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_ustvidDZ, sub_menu_ust_compDZ4);//инит control и формир кадра
    204            if(flg==0)//END
    205            {
    206              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    207            }//if
    208          
    209            ViewDiskrMenuList();//вывести окно отображения
    210            ListPStr();//доступ к уставкам
    211          }//PereinitUstListComp3()
    212          
    213          void UstListCompDZ4()
    214          {
    215            SelectorMNGBAZA(0);//установка базу уставок
    216          
    217            SelectorSUBMENU(sub_menu_ust_compDZ4);//уcтановить текущее субменю
    218          
    219            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    220          
    221            SelectorFHOME(&PereinitUstListCompDZ4);//указатель на ф-цию HOME
    222            InitFHOME(1);//exe ф-цию HOME
    223          
    224            LanderUpDown();//wkl Up Down
    225          }//UstListCompDZ4()
    226          
    227          void UstCompDZ4()
    228          {
    229            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    230            PrepareEditMenu(sub_menu_ust_compDZ4);
    231            PassWord(EditUstDZ4);
    232          }//VidCompDZ4()
    233          
    234          void EditUstDZ4()
    235          {
    236          //редактировать уставку
    237            SystemEditUst(sub_menu_ust_compDZ4);//[LIGHTLINEMENU +1+SUBDATA].Line1, LIGHTLINEMENU);
    238          }//UstCompDZ4()
    239          
    240          //--------------------------------------------------
    241          
    242          void PereinitVidListCompDZ4(short flg)
    243          {
    244          //переиниц
    245            //инит компонентного контроля
    246            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_ustvidDZ, sub_menu_vid_compDZ4);//инит control и формир кадра
    247            if(flg==0)//END
    248            {
    249              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    250            }//if
    251          
    252            ViewDiskrMenuList();//вывести окно отображения
    253            ListPStr();//доступ к уставкам
    254          }//PereinitVidListCompDZ4(short flg)
    255          
    256          void VidListCompDZ4()
    257          {
    258            SelectorMNGBAZA(MNGVID_DZ2to5MF);//установка базы уставок
    259          
    260            SelectorSUBMENU(sub_menu_vid_compDZ4);//утановить текущее субменю
    261          
    262            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    263          
    264            SelectorFHOME(&PereinitVidListCompDZ4);//указатель на ф-цию HOME
    265            InitFHOME(1);//exe ф-цию HOME
    266          
    267            LanderUpDown();//wkl Up Down
    268          }//VidListCompDZ4()
    269          
    270          void VidCompDZ4()
    271          {
    272            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    273            PrepareEditMenu(sub_menu_vid_compDZ4);
    274          //  PassWord(EditVidAPV);
    275            EditVidDZ4();
    276          }//VidCompDZ4()
    277          
    278          void EditVidDZ4()
    279          {
    280          //редактировать уставку
    281            SystemEditUst(sub_menu_vid_compDZ4);//[LIGHTLINEMENU +1+SUBDATA].Line1, LIGHTLINEMENU);
    282          }//
    283          
    284          //--------------------------------------------------
    285          
    286          void PereinitUprListCompDZ4(short flg)
    287          {
    288          //переиниц
    289            //инит компонентного контроля
    290            TxtStreamInit(&CONTROL2_COMP, &KadrMenuFormat_upr_compDZ4, NULL);//инит control и формир кадра
    291            if(flg==0)//END
    292            {
    293              TxtStreamSetEnd(&CONTROL2_COMP, SIZE_PAGE_VIEW/2);//перейти на END
    294            }//if
    295          
    296            ViewDiskrMenuList();//вывести окно отображения
    297            ListPStr();//доступ к уставкам
    298          }//PereinitUstListComp2()
    299          
    300          void UprListCompDZ4()
    301          {
    302            SelectorMNGBAZA(MNGUPR_DZ2to5);//установка базы уставок
    303          
    304            SelectorSUBMENU(sub_menu_upr_compDZ4);//утановить текущее субменю
    305          
    306            SelectorTEXTCONTROL(&CONTROL2_COMP);//текущий control
    307          
    308            SelectorFHOME(&PereinitUprListCompDZ4);//указатель на ф-цию HOME
    309            InitFHOME(1);//exe ф-цию HOME
    310          
    311            LanderUpDown();//wkl Up Down
    312          }//VidListCompDZ4()
    313          
    314          void UprCompDZ4()
    315          {
    316            SelectorCRRLIGHTLINE();//найти подсвеченную строку текущего текст потока
    317            PrepareEditMenu(sub_menu_upr_compDZ4);
    318            PassWord(EditUprDZ4);
    319          
    320          }//UprCompMTZ4()
    321          
    322          void EditUprDZ4()
    323          {
    324          //редактировать уставку упр
    325            char *nameUpr = (char *)sub_menu_upr_compDZ4[LIGHTLINEMENU +1+SUBDATA].Line1;
    326            UpravlRedactor(nameUpr, LIGHTLINEMENU, &selectorUprStrDZ2);//редактировать уставку управления
    327          }//EditUprDZ4()
    328          
    329          short  KadrMenuFormat_upr_compDZ4(void *pstr)
    330          {
    331           WorkControl *workCntr = (WorkControl *)pstr;
    332          //формирователь кадра
    333            RESET_COUNTER;//сброс счетчиков
    334            for(int i=0;; i++)
    335            {
    336          //критерий терминатора
    337              char *nameUpr = (char *)sub_menu_upr_compDZ4[i+1+SUBDATA].Line1;
    338              if(nameUpr==NULL) break;
    339          
    340              COMPARE_COUNTER
    341              {
    342                strcpy((char *)workCntr->twoString, nameUpr);
    343          
    344                //UpravlViewerInKadr(nameUpr, i, workCntr);//отобразить уставку управления в кадре
    345                strcpy((char *)workCntr->twoString + sizeof(WorkVariantChar)/2,
    346                selectorUprStrDZ2(i, getCurrentMngUSTAVKI()));
    347          
    348                return 1;//сравнить счетчики кадров
    349              }
    350            }//for
    351          
    352            return 1;
    353          }//KadrMenuFormat_upr_compDZ4(WorkControl *workCntr)
    354          
    355          int initUstDZ4(char init)
    356          {
    357           return initUstDZ2(init);
    358          }//initUstDZ4(short mngUst, char init)
    359          
    360          void  prepareUstDZ4(short idxC)
    361          {
    362            prepareUstDZ2(idxC);
    363          }//prepareUstDZ3(short idxC)
    364          
    365          int codecUstDZ4(char codec, short offset, int ust)
    366          //codec=0-кодировать
    367          //codec=1-раскодировать
    368          {
    369            return codecUstDZ2(codec, offset, ust);
    370          }//codecUstDZ4(char *buf, short offset, int ust)
    371          
    372          void diffDZ4ToRepozitar()
    373          {
    374          //копировать изменения компонента в репозитарий
    375            rpzcomponent_obj.componentEnable = 1;//разрешение компонента
    376            rpzcomponent_obj.kodC   = KOD_COMPONENT;         //код компонента
    377            rpzcomponent_obj.permanent = 0; //перманентный компонент
    378          
    379            strcpy(rpzcomponent_obj.nameComponent,  DZ4_TITLE);       //имя компонента
    380            rpzcomponent_obj.sub_menu_component =  sub_menu_comp_DZ4;//sub_menu_component;
    381          
    382            rpzcomponent_obj.cntClon     = CNT_STUPEN_DZ;   //к-во клонов
    383            rpzcomponent_obj.numClon     = 4;//номер клона
    384            rpzcomponent_obj.workToSignal = 0; //Работа на сигнал
    385          
    386            rpzcomponent_obj.initUstMng     = initUstDZ4;    //инициал уставок
    387            rpzcomponent_obj.prepareUstSpv  = prepareUstDZ4;//подготовка уставок
    388          
    389            rpzcomponent_obj.nameStatusIO = ionsDZ4;          //имена и статус команд IO
    390          
    391            rpzcomponent_obj.codecUst = codecUstDZ4;   //кодировать-раскодировать уставку
    392          }//
    393          
    394          #endif // _HIDE_COMPONENT
    395          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   EditUprDZ4
         8   -> UpravlRedactor
       8   EditUstDZ4
         8   -> SystemEditUst
       8   EditVidDZ4
         8   -> SystemEditUst
      24   KadrMenuFormat_upr_compDZ4
        24   -> getCurrentMngUSTAVKI
        24   -> selectorUprStrDZ2
        24   -> strcpy
       8   PereinitUprListCompDZ4
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   PereinitUstListCompDZ4
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   PereinitVidListCompDZ4
         8   -> ListPStr
         8   -> TxtStreamInit
         8   -> TxtStreamSetEnd
         8   -> ViewDiskrMenuList
       8   UprCompDZ4
         8   -> PassWord
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   UprListCompDZ4
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
       8   UstCompDZ4
         8   -> PassWord
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   UstListCompDZ4
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
       8   VidCompDZ4
         8   -> EditVidDZ4
         8   -> PrepareEditMenu
         8   -> SelectorCRRLIGHTLINE
       8   VidListCompDZ4
         8   -> InitFHOME
         8   -> LanderUpDown
         8   -> SelectorFHOME
         8   -> SelectorMNGBAZA
         8   -> SelectorSUBMENU
         8   -> SelectorTEXTCONTROL
      16   codecUstDZ4
        16   -> codecUstDZ2
       8   diffDZ4ToRepozitar
         8   -> strcpy
       8   initUstDZ4
         8   -> initUstDZ2
       8   prepareUstDZ4
         8   -> prepareUstDZ2


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable13
       4  ??DataTable13_1
       4  ??DataTable13_10
       4  ??DataTable13_11
       4  ??DataTable13_2
       4  ??DataTable13_3
       4  ??DataTable13_4
       4  ??DataTable13_5
       4  ??DataTable13_6
       4  ??DataTable13_7
       4  ??DataTable13_8
       4  ??DataTable13_9
      16  ?_0
      16  ?_1
      12  ?_10
      16  ?_11
      16  ?_12
       8  ?_13
      16  ?_14
      16  ?_15
      12  ?_16
      12  ?_17
      16  ?_18
      16  ?_19
      16  ?_2
      16  ?_20
      16  ?_21
      16  ?_3
      12  ?_4
      20  ?_5
      16  ?_6
      16  ?_7
      12  ?_8
      16  ?_9
       4  DZ4_TITLE
      52  EditUprDZ4
      16  EditUstDZ4
      16  EditVidDZ4
     160  KadrMenuFormat_upr_compDZ4
      68  PereinitUprListCompDZ4
      68  PereinitUstListCompDZ4
      68  PereinitVidListCompDZ4
      28  UprCompDZ4
      52  UprListCompDZ4
      28  UstCompDZ4
      52  UstListCompDZ4
      24  VidCompDZ4
      52  VidListCompDZ4
      48  codecUstDZ4
     152  diffDZ4ToRepozitar
      24  initUstDZ4
      80  ionsDZ4
      28  prepareUstDZ4
      96  sub_menu_comp_DZ4
      96  sub_menu_upr_compDZ4
      84  sub_menu_ust_compDZ4
      36  sub_menu_vid_compDZ4

 
 396 bytes in section .data
 328 bytes in section .rodata
 984 bytes in section .text
 
 984 bytes of CODE  memory
 328 bytes of CONST memory
 396 bytes of DATA  memory

Errors: none
Warnings: none
